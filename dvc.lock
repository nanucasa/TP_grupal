schema: '2.0'
stages:
  data_prep:
    cmd: python src\data_prep.py --input data\raw\telco_churn.csv --outdir 
      data\processed --seed 42 --test-size 0.2 --val-size 0.1
    deps:
    - path: data\raw\telco_churn.csv
      hash: md5
      md5: 25e331349d6fc3e8608b1deaf35f4c71
      size: 882933
    - path: src\data_prep.py
      hash: md5
      md5: aefaa2cac76a71bb4f666e6c300b1912
      size: 4989
    outs:
    - path: data\processed
      hash: md5
      md5: 614060690e60b1ab4f301e442dd7136f.dir
      size: 1023708
      nfiles: 4
  train:
    cmd: python src\train.py --train data\processed\train.csv --valid 
      data\processed\valid.csv --out-model models\model.joblib --metrics 
      metrics.json --best-params artifacts\best_params.json --params params.yaml
    deps:
    - path: artifacts\best_params.json
      hash: md5
      md5: 35999a62ede63cb3e458d4c11a6101af
      size: 38
    - path: data\processed\train.csv
      hash: md5
      md5: 8f5c35515f9f2ed31d9555ba58b1579b
      size: 715729
    - path: data\processed\valid.csv
      hash: md5
      md5: d33f3c1653cac4c9d9cc14227f77ee79
      size: 102550
    - path: src\train.py
      hash: md5
      md5: 6b4a402b8d1bcf0676f65bdf3d0befd4
      size: 4349
    params:
      params.yaml:
        train.C: 1.0
        train.max_iter: 1000
        train.seed: 42
    outs:
    - path: metrics.json
      hash: md5
      md5: 440a0c42ab8a2dcac8fd289c5be9313a
      size: 224
    - path: models\model.joblib
      hash: md5
      md5: 95745aa7ecee96a9eb9ce8bcea139ca7
      size: 1921
  evaluate_test:
    cmd: python src\evaluate.py --test data\processed\test.csv --model 
      models\model.joblib --metrics-out metrics_test.json
    deps:
    - path: artifacts\best_threshold.json
      hash: md5
      md5: 11edafd393b622bd4d7085d16a8c9ded
      size: 44
    - path: data\processed\test.csv
      hash: md5
      md5: 504c23a16229ee2680239bd7f5206d4c
      size: 204688
    - path: models\model.joblib
      hash: md5
      md5: 636a0e94896d6158a2231dc1243060aa
      size: 1973
    - path: src\evaluate.py
      hash: md5
      md5: fdda023f595d55dae270d990e5445037
      size: 2973
    outs:
    - path: metrics_test.json
      hash: md5
      md5: c74c9b2a9adcaf60f08cd6b9871ee0f4
      size: 256
  tune:
    cmd: python src\tune.py --train data\processed\train.csv --valid 
      data\processed\valid.csv --params params.yaml --best-out 
      artifacts\best_params.json --metrics-out metrics_tune.json
    deps:
    - path: data\processed\train.csv
      hash: md5
      md5: 8f5c35515f9f2ed31d9555ba58b1579b
      size: 715729
    - path: data\processed\valid.csv
      hash: md5
      md5: d33f3c1653cac4c9d9cc14227f77ee79
      size: 102550
    - path: params.yaml
      hash: md5
      md5: be9cb0dcac06a29cf06fca39e4b1fd41
      size: 392
    - path: src\tune.py
      hash: md5
      md5: 6069d1e128d49a26f0d42bcb56533ac3
      size: 3442
    outs:
    - path: artifacts\best_params.json
      hash: md5
      md5: 35999a62ede63cb3e458d4c11a6101af
      size: 38
    - path: metrics_tune.json
      hash: md5
      md5: 37cb809e039c09bc348f9e3301e59cff
      size: 283
  predict_test:
    cmd: python src\predict.py --input data\processed\test.csv --model 
      models\model.joblib --output predictions\preds_test.csv
    deps:
    - path: artifacts\best_threshold.json
      hash: md5
      md5: 11edafd393b622bd4d7085d16a8c9ded
      size: 44
    - path: data\processed\test.csv
      hash: md5
      md5: 504c23a16229ee2680239bd7f5206d4c
      size: 204688
    - path: models\model.joblib
      hash: md5
      md5: ed3a6a07bcf55464804970d8e94a66c4
      size: 1973
    - path: src\predict.py
      hash: md5
      md5: d062f3ec68a89efa2b321776425beb88
      size: 1740
    outs:
    - path: predictions\preds_test.csv
      hash: md5
      md5: 6106bac0055fff4091743986526e47fe
      size: 243063
  threshold:
    cmd: python src\threshold.py --valid data\processed\valid.csv --model 
      models\model.joblib --out-json artifacts\best_threshold.json --metrics-out
      metrics_threshold.json --roc-out reports\roc_curve.png --pr-out 
      reports\pr_curve.png
    deps:
    - path: data\processed\valid.csv
      hash: md5
      md5: d33f3c1653cac4c9d9cc14227f77ee79
      size: 102550
    - path: models\model.joblib
      hash: md5
      md5: 39f0d75a7b356fcfb17a1bbf9d2beeec
      size: 1973
    - path: src\threshold.py
      hash: md5
      md5: 71e2e6bb6a7306312586cda7c1de76a4
      size: 4262
    outs:
    - path: artifacts\best_threshold.json
      hash: md5
      md5: 11edafd393b622bd4d7085d16a8c9ded
      size: 44
    - path: metrics_threshold.json
      hash: md5
      md5: 12944f9e35b28d325d3acdae8c9500e8
      size: 230
    - path: reports\pr_curve.png
      hash: md5
      md5: f0d17ca82200ce04bf87d4c1ee169af4
      size: 20959
    - path: reports\roc_curve.png
      hash: md5
      md5: 387ba5a3156416cf4ba3e491c9390a3f
      size: 21061
  tune_rf:
    cmd: python src\tune_rf.py --train data\processed\train.csv --valid 
      data\processed\valid.csv --params params.yaml --best-out 
      artifacts\best_params_rf.json --metrics-out metrics_tune_rf.json
    deps:
    - path: data\processed\train.csv
      hash: md5
      md5: 8f5c35515f9f2ed31d9555ba58b1579b
      size: 715729
    - path: data\processed\valid.csv
      hash: md5
      md5: d33f3c1653cac4c9d9cc14227f77ee79
      size: 102550
    - path: params.yaml
      hash: md5
      md5: be9cb0dcac06a29cf06fca39e4b1fd41
      size: 392
    - path: src\tune_rf.py
      hash: md5
      md5: 826db2dd7b03e243cc5ab8e7778686ff
      size: 3211
    outs:
    - path: artifacts\best_params_rf.json
      hash: md5
      md5: c71fa5d6dea7e9064e8986b26093b647
      size: 73
    - path: metrics_tune_rf.json
      hash: md5
      md5: c1cd69eb386aa85d8300b29595dfe95f
      size: 361
  train_rf:
    cmd: python src\train_rf.py --train data\processed\train.csv --valid 
      data\processed\valid.csv --out-model models\model_rf.joblib --metrics 
      metrics_rf.json --best-params artifacts\best_params_rf.json --params 
      params.yaml
    deps:
    - path: artifacts\best_params_rf.json
      hash: md5
      md5: c71fa5d6dea7e9064e8986b26093b647
      size: 73
    - path: data\processed\train.csv
      hash: md5
      md5: 8f5c35515f9f2ed31d9555ba58b1579b
      size: 715729
    - path: data\processed\valid.csv
      hash: md5
      md5: d33f3c1653cac4c9d9cc14227f77ee79
      size: 102550
    - path: params.yaml
      hash: md5
      md5: be9cb0dcac06a29cf06fca39e4b1fd41
      size: 392
    - path: src\train_rf.py
      hash: md5
      md5: 5b33c7e164067f89cc28bb8f82bdeb76
      size: 4533
    outs:
    - path: metrics_rf.json
      hash: md5
      md5: db1a437ed01b94c1b9d1e3dd744bec94
      size: 263
    - path: models\model_rf.joblib
      hash: md5
      md5: e2792ca8cb75172aac35c6b9c336255d
      size: 1576313
  evaluate_test_rf:
    cmd: python src\evaluate.py --test data\processed\test.csv --model 
      models\model_rf.joblib --metrics-out metrics_test_rf.json
    deps:
    - path: artifacts\best_threshold.json
      hash: md5
      md5: 11edafd393b622bd4d7085d16a8c9ded
      size: 44
    - path: data\processed\test.csv
      hash: md5
      md5: 504c23a16229ee2680239bd7f5206d4c
      size: 204688
    - path: models\model_rf.joblib
      hash: md5
      md5: 14afcaf8276027fa690e3e45ef173149
      size: 1576365
    - path: src\evaluate.py
      hash: md5
      md5: fdda023f595d55dae270d990e5445037
      size: 2973
    outs:
    - path: metrics_test_rf.json
      hash: md5
      md5: af05d7b06a0f23e899c420b314c3f02c
      size: 258
  tune_xgb:
    cmd: python src\tune_xgb.py --train data\processed\train.csv --valid 
      data\processed\valid.csv --params params.yaml --best-out 
      artifacts\best_params_xgb.json --metrics-out metrics_tune_xgb.json
    deps:
    - path: data\processed\train.csv
      hash: md5
      md5: 8f5c35515f9f2ed31d9555ba58b1579b
      size: 715729
    - path: data\processed\valid.csv
      hash: md5
      md5: d33f3c1653cac4c9d9cc14227f77ee79
      size: 102550
    - path: params.yaml
      hash: md5
      md5: 55cecc886671194e85d111e14bb00daf
      size: 665
    - path: src\tune_xgb.py
      hash: md5
      md5: 044e2f84f0326eb3c126937252450ef1
      size: 3088
    outs:
    - path: artifacts\best_params_xgb.json
      hash: md5
      md5: 5292a78f760cf7607db0069a05f83a4d
      size: 237
    - path: metrics_tune_xgb.json
      hash: md5
      md5: 7f26a71f3eeb4e6d07fff2ba43bda940
      size: 322
  train_xgb:
    cmd: python src\train_xgb.py --train data\processed\train.csv --valid 
      data\processed\valid.csv --out-model models\model_xgb.joblib --metrics 
      metrics_xgb.json --best-params artifacts\best_params_xgb.json --params 
      params.yaml
    deps:
    - path: artifacts\best_params_xgb.json
      hash: md5
      md5: 5292a78f760cf7607db0069a05f83a4d
      size: 237
    - path: data\processed\train.csv
      hash: md5
      md5: 8f5c35515f9f2ed31d9555ba58b1579b
      size: 715729
    - path: data\processed\valid.csv
      hash: md5
      md5: d33f3c1653cac4c9d9cc14227f77ee79
      size: 102550
    - path: params.yaml
      hash: md5
      md5: 55cecc886671194e85d111e14bb00daf
      size: 665
    - path: src\train_xgb.py
      hash: md5
      md5: adbd9987afbb3c968b531900dbefb147
      size: 3550
    outs:
    - path: metrics_xgb.json
      hash: md5
      md5: e18573c024ac686f5dbc507fcab1fce8
      size: 424
    - path: models\model_xgb.joblib
      hash: md5
      md5: d35a1a2e10a839c822d69cefde571a6a
      size: 353662
  threshold_xgb:
    cmd: python src\threshold.py --valid data\processed\valid.csv --model 
      models\model_xgb.joblib --out-json artifacts\best_threshold_xgb.json 
      --metrics-out metrics_threshold_xgb.json --roc-out 
      reports\roc_curve_xgb.png --pr-out reports\pr_curve_xgb.png
    deps:
    - path: data\processed\valid.csv
      hash: md5
      md5: d33f3c1653cac4c9d9cc14227f77ee79
      size: 102550
    - path: models\model_xgb.joblib
      hash: md5
      md5: d35a1a2e10a839c822d69cefde571a6a
      size: 353662
    - path: src\threshold.py
      hash: md5
      md5: 71e2e6bb6a7306312586cda7c1de76a4
      size: 4262
    outs:
    - path: artifacts\best_threshold_xgb.json
      hash: md5
      md5: ca765217a488351d33127da20c96ab3c
      size: 44
    - path: metrics_threshold_xgb.json
      hash: md5
      md5: c443f1ecf13f2484c235c041fe9b5426
      size: 221
    - path: reports\pr_curve_xgb.png
      hash: md5
      md5: 53f4c502b59eb81d3c195152a0981860
      size: 21552
    - path: reports\roc_curve_xgb.png
      hash: md5
      md5: dabc3466c0491b079be2b0c908ba89ee
      size: 21135
  evaluate_test_xgb:
    cmd: python src\evaluate.py --test data\processed\test.csv --model 
      models\model_xgb.joblib --threshold-file artifacts\best_threshold_xgb.json
      --metrics-out metrics_test_xgb.json
    deps:
    - path: artifacts\best_threshold_xgb.json
      hash: md5
      md5: ca765217a488351d33127da20c96ab3c
      size: 44
    - path: data\processed\test.csv
      hash: md5
      md5: 504c23a16229ee2680239bd7f5206d4c
      size: 204688
    - path: models\model_xgb.joblib
      hash: md5
      md5: d35a1a2e10a839c822d69cefde571a6a
      size: 353662
    - path: src\evaluate.py
      hash: md5
      md5: 682ce56ccf5862239c62c6ebc55c9dd9
      size: 2503
    outs:
    - path: metrics_test_xgb.json
      hash: md5
      md5: 6904d8a683a5ab08d1d891faedaac804
      size: 259
